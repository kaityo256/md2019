# 圧力

## 局所量定義の難しさ

MDシミュレーションをしていると、温度や圧力といった物理量の時間変化を見たくなる。さらに、系全体のマクロな量だけでなく、「系のこの部分の温度」「系のこの部分の圧力」といった局所的な量も知りたくなる。しかし、分子動力学法の支配方程式はハミルトンの運動方程式であるから、我々が使える「材料」は運動量、座標、そして全エネルギーだけである。これらの材料から欲しい物理量すべてを「調理」しなければならない。系全体の物理量はともかく、局所的な物理量定義は難しい。以下、その難しさを見てみよう。

### 一体関数の局所物理量

3次元$N$粒子系、二体相互作用系を考えよう。簡単のため、質量はすべて等しいとすると、ハミルトニアンは以下のように書ける。

$$
H = \sum_i \frac{\vec{p}_i^2}{2m} + \sum_{i < j} V(q_{ij})
$$

ただし、$q_ij \equiv |\vec{q}_i - \vec{q}_j|$である。

局所的な物理量とは、「系の部分的な空間を指定し、その部分空間で定義される量」である。一番簡単な量は局所数密度であろう。部分空間の中に含まれる粒子の数を数えて、空間の体積で割ればよい。これをちゃんと定義するために、数密度分布関数$\rho(\vec{r})$を作ろう。

$$
\rho(\vec{r}) = \sum_i \delta(\vec{r} - \vec{q}_i)
$$

ある部分空間$\Omega$における数密度$\rho_\Omega$は、上記の量を積分すれば得られる。

$$
\rho_\Omega = \frac{1}{|\Omega|}\int_\Omega \rho(\vec{r}) d \vec{r}
$$

先程の「$\Omega$の中の粒子数を数えて空間体積$|\Omega|$で割る」という文章を数式で書いただけであり、全空間にわたって積分すれば

$$
\rho = \frac{N}{V}
$$

になる。

同様に、局所的な運動温度$T_\Omega$を定義してみよう。

$$
\left< \frac{\vec{p}_i^2}{2m}\right> = \frac{3}{2}k_B T
$$

であったから、

$$
\frac{3}{2} k_B T_\Omega = \frac{|\Omega|}{\rho_\Omega} \int_\Omega \sum_i \frac{\vec{p}_i^2}{2m} \delta(\vec{r} - \vec{q}_i) d \vec{r}
$$

と定義するのが自然であろう。やはり全空間にわたって積分すれば

$$
\frac{3}{2} k_B T = \frac{1}{N} \sum_i \frac{\vec{p}_i^2}{2m}
$$

と、運動エネルギーの平均を計算しているだけであることがわかる。

### 二体関数の局所物理量

一体関数で定義できる局所物理量は「その部分空間に含まれる粒子の平均」を取るだけで良いので簡単であった。しかし、粒子系の相互作用が効いてくるような二体以上の関数が関わってくると話がややこしくなる。そんな、二体関数が関係する物理量の例がエネルギーである。ハミルトニアンが

$$
H = \sum_i \frac{\vec{p}_i^2}{2m} + \sum_{i < j} V(q_{ij})
$$

と、一体の運動エネルギーと二体のポテンシャルエネルギーの和で書かれているため、エネルギーの計算には二体関数が関わってくる。このエネルギーの局所定義はどのようにすればよいだろうか？


