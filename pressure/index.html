<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>

<style>
    .btn-square {
      display: inline-block;
      padding: 0.5em 0.5em;
      text-decoration: none;
      background: #668ad8;
      color: #FFF;
      border-bottom: solid 4px #626295;
      border-radius: 5px;
    }

    .btn-square:active {
      -webkit-transform: translateY(4px);
      transform: translateY(4px);
      border-bottom: none;
    }
  .markdown-body {
    box-sizing: border-box;
    min-width: 200px;
    max-width: 980px;
    margin: 0 auto;
    padding: 45px;
  }
  p.caption{
    display:none;
  }
  img {width: 100%}

  @media (max-width: 767px) {
    .markdown-body {
      padding: 15px;
    }
  }
</style>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://kaityo256.github.io/python_zero/github-markdown.css" type="text/css" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
</head>
<body>
<article class="markdown-body">
<h1 id="圧力">圧力</h1>
<p><a href="../index.html">[Up]</a> <a href="https://github.com/kaityo256/md2019">[Repository]</a></p>
<h2 id="圧力の定義">圧力の定義</h2>
<p>しつこいが、分子動力学法において規定されているのは全エネルギーのみである。それ以外の物理量は我々が定義しなければならない。ここでは、圧力について考えてみよう。以下、系全体が感じる大域的な圧力と、局所的な圧力の定義について論じる。</p>
<h2 id="大域圧力の導出">大域圧力の導出</h2>
<h3 id="古典的なビリアル定理">古典的なビリアル定理</h3>
<p>教科書によく書いてある古典的なビリアル定理から圧力を定義してみよう。天下りだが、以下のような量を考えよう。</p>
<p><span class="math display">\[
G = \sum_i \vec{p}_i \cdot \vec{q}_i
\]</span></p>
<p>両辺を時間微分してみる。</p>
<p><span class="math display">\[
\begin{aligned}
\dot{G} &amp;= \sum_i \underbrace{\vec{p}_i \cdot \dot{\vec{q}}_i}_{(1)} + \sum_i \underbrace{\dot{\vec{p}}_i \cdot \vec{q}_i}_{(2)}
\end{aligned}
\]</span></p>
<p>まず(1)の項だが、<span class="math inline">\(\dot{\vec{q}}_i = \vec{p}_i/m\)</span>であるから、</p>
<p><span class="math display">\[
\vec{p}_i \cdot \dot{\vec{q}}_i  = \frac{\vec{p}_i^2}{m}
\]</span></p>
<p>である。エネルギー等分配則から</p>
<p><span class="math display">\[
\frac{\vec{p}_i^2}{m} = 3 k_B T
\]</span></p>
<p>和を取ると、</p>
<p><span class="math display">\[
\sum_i \frac{\vec{p}_i^2}{m} = 3 Nk_B T
\]</span></p>
<p>次に、(2)だが、<span class="math inline">\(\dot{\vec{p}}_i = \vec{f}_i\)</span>であるから、</p>
<p><span class="math display">\[
\dot{\vec{p}}_i \cdot \vec{q}_i = \vec{q}_i \cdot \vec{f}_i 
\]</span></p>
<p>ここで<span class="math inline">\(\vec{f}_i\)</span>は、粒子<span class="math inline">\(i\)</span>にかかる力である。ここで、粒子間に働く力と、外力<span class="math inline">\(\vec{f}^\mathrm{ext}_i\)</span>にわけよう。粒子間力は二体力とし、粒子<span class="math inline">\(j\)</span>から<span class="math inline">\(i\)</span>に働く力を<span class="math inline">\(\vec{f}_{ij}\)</span>とすると、</p>
<p><span class="math display">\[
\dot{\vec{p}}_i \vec{q}_i = \vec{q}_i \sum_{i\neq j} \vec{f}_{ij} + \vec{q}_i  \cdot \vec{f}^\mathrm{ext}_i
\]</span></p>
<p>と書ける。<span class="math inline">\(i\)</span>に関する和を取ると、</p>
<p><span class="math display">\[
\begin{aligned}
\sum_i \dot{\vec{p}}_i \vec{q}_i &amp;= \underbrace{\sum_i \vec{q}_i \sum_{i\neq j} \vec{f}_{ij}}_{(3)} + \underbrace{\sum_i \vec{q}_i \cdot \vec{f}^\mathrm{ext}_i}_{(4)}
\end{aligned}
\]</span></p>
<p>まずは(3)について計算しよう。</p>
<p><span class="math display">\[
\begin{aligned}
(3) &amp;=  \sum_i \vec{q}_i \sum_{i\neq j} \vec{f}_{ij} \\
&amp;= \sum_{i&lt; j} \left( \vec{q}_i  \cdot \vec{f}_{ij} + \vec{q}_j  \cdot \vec{f}_{ji} \right) \\
&amp;=  \sum_{i&lt; j}\left( \vec{q}_i  \cdot \vec{f}_{ij} - \vec{q}_j  \cdot \vec{f}_{ij} \right) \\
&amp;=  \sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}
\end{aligned}
\]</span></p>
<p>ただし、<span class="math inline">\(\vec{q}_{ij} = \vec{q}_i - \vec{q}_j\)</span>である。</p>
<p>次に、外力からの寄与(4)を計算する。<span class="math inline">\(\vec{f}^\mathrm{ext}_i\)</span>は、外力から粒子<span class="math inline">\(i\)</span>に働く力であるから、その反作用が壁に働く。従って、</p>
<p><span class="math display">\[
\begin{aligned}
(4) &amp;= \sum_i \vec{q}_i \cdot \vec{f}^\mathrm{ext}_i \\
&amp;= -  \int_{\partial V} \vec{r} \cdot (P\vec{n}) d A \\
&amp;= -P \int_V \underbrace{\nabla \cdot \vec{r}}_3 dV \\
&amp;= -3PV
\end{aligned}
\]</span></p>
<p>ただし、途中でガウスの定理を使った。また、</p>
<p><span class="math display">\[
\nabla \cdot \vec{r} = \frac{\partial x}{\partial x} +
\frac{\partial y}{\partial y} +
\frac{\partial z}{\partial z}  = 3
\]</span></p>
<p>を用いた。</p>
<p>以上から、</p>
<p><span class="math display">\[
\dot{G} = 3Nk_B T + \sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij} -3PV
\]</span></p>
<p>となった。</p>
<p>次に、両辺の時間平均を取ろう。時間変化する物理量<span class="math inline">\(A(t)\)</span>の時間平均<span class="math inline">\(\bar{A}\)</span>は、</p>
<p><span class="math display">\[
\bar{A} \equiv \lim_{\tau \rightarrow \infty} \frac{1}{\tau}
\int_0^\tau dt A(t)
\]</span></p>
<p>で定義される。<span class="math inline">\(\dot{G}\)</span>の時間平均は</p>
<p><span class="math display">\[
\begin{aligned}
\bar{\dot{G}} &amp;= \lim_{\tau \rightarrow \infty} \frac{1}{\tau}
\int_0^\tau dt \dot{G}(t)\\
&amp;= \lim_{\tau \rightarrow \infty} \frac{G(\tau) - G(0)}{\tau}
\end{aligned}
\]</span></p>
<p>ここで、<span class="math inline">\(G\)</span>という量に上限があるなら、十分に長い<span class="math inline">\(\tau\)</span>を取ればゼロになる。以上から、</p>
<p><span class="math display">\[
\bar{\dot{G}} = 3Nk_B T + \overline{\sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}} -3PV = 0
\]</span></p>
<p>時間平均<span class="math inline">\(\bar{A}\)</span>とアンサンブル平均<span class="math inline">\(\left&lt; A\right&gt;\)</span>を同一視すると、</p>
<p><span class="math display">\[
PV = N k_BT + \frac{1}{3} \left&lt; \sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}\right&gt;
\]</span></p>
<p>これが古典的なビリアル定理による、粒子系の圧力の導出である。最初の<span class="math inline">\(N k_B T\)</span>が理想気体からの寄与、つまり粒子の運動から圧力への寄与であり、右辺第二項が相互作用からの寄与である。</p>
<h3 id="分配関数からの導出">分配関数からの導出</h3>
<p>さて、先ほどのビリアル定理からの圧力の導出では、</p>
<ul>
<li>いきなり<span class="math inline">\(G\)</span>という量を定義して時間微分する意味が不明瞭</li>
<li>粒子にかかる力を粒子間力と外力に分けたが、周期境界条件ではどうなるかわかりにくい</li>
</ul>
<p>という問題がある。そこで、「分子動力学法の世界にはハミルトニアンしか存在しない」という立場から、分配関数経由で導出してみよう。</p>
<p>まずはこの系のハミルトニアンを定義しよう。</p>
<p><span class="math display">\[
H = \sum_i \frac{\vec{p}_i^2}{2m} + \sum_{i &lt; j} \Phi(q_{ij})
\]</span></p>
<p>これがこの系の全エネルギーを定義する。</p>
<p>さて、熱力学関係式</p>
<p><span class="math display">\[
P = - \left(\frac{\partial F}{\partial V} \right)_T
\]</span></p>
<p>から出発しよう。<span class="math inline">\(P\)</span>は圧力、<span class="math inline">\(T\)</span>が温度、<span class="math inline">\(F\)</span>はヘルムホルツ自由エネルギーである。</p>
<p>ヘルムホルツ自由エネルギーは分配関数<span class="math inline">\(Z\)</span>を用いて</p>
<p><span class="math display">\[
F = - k_B T \ln Z
\]</span></p>
<p>と書けるので、</p>
<p><span class="math display">\[
\begin{aligned}
P &amp;= - \left(\frac{\partial F}{\partial V} \right)_T\\
&amp;= k_B T \frac{\partial\ln Z }{\partial V}
= k_B T \frac{1}{Z} \frac{\partial Z}{\partial V}
\end{aligned}
\]</span></p>
<p>となる。さて、分配関数はハミルトニアン<span class="math inline">\(H\)</span>を用いて</p>
<p><span class="math display">\[
Z = \int d \Gamma \mathrm{e}^{-\beta H}
\]</span></p>
<p>と書けるから、</p>
<p><span class="math display">\[
\frac{\partial Z}{\partial V} = \int d \Gamma \left(-\beta \frac{\partial H}{\partial V} \right) \mathrm{e}^{-\beta H}
\]</span></p>
<p>である。これを先程の式に代入して整理すると、</p>
<p><span class="math display">\[
\begin{aligned}
P &amp;= - Z^{-1} \int d \Gamma \left(\frac{\partial H}{\partial V} \right) \mathrm{e}^{-\beta H} \\
&amp;= -\left&lt; \frac{\partial H}{\partial V} \right&gt;
\end{aligned}
\]</span></p>
<p>すなわち、圧力を求めるにはハミルトニアンの体積微分のアンサンブル平均を取れば良い。 もちろんこの式は、熱力学関係式</p>
<p><span class="math display">\[
P = - \left(\frac{\partial U}{\partial V} \right)_S
\]</span></p>
<p>に対応している。</p>
<p>さて、ハミルトニアンの体積微分を取るために、系のサイズを変化させることを考えよう。一辺<span class="math inline">\(L\)</span>の立方体の系を考えると、<span class="math inline">\(V=L^3\)</span>である。この系の長さを一様に<span class="math inline">\(L \rightarrow \alpha L\)</span>と拡大することを考える。</p>
<p>拡大された世界のハミルトニアンは</p>
<p><span class="math display">\[
H(\alpha) = \sum_i \frac{\alpha^2 \vec{p}_i^2}{2m} + \sum_{i &lt; j} \Phi(\alpha q_{ij})
\]</span></p>
<p>となる。</p>
<p>やや紛らわしいが、<span class="math inline">\(\alpha = 1\)</span>の時の体積を<span class="math inline">\(V\)</span>とすると、<span class="math inline">\(V \rightarrow \alpha^3 V\)</span>となるから</p>
<p><span class="math display">\[
dV = 3 \alpha^2 V d \alpha
\]</span></p>
<p>となる(微分する変数としての<span class="math inline">\(V\)</span>と基準体積<span class="math inline">\(V\)</span>で同じ記号を使っていることに注意)。これにより、</p>
<p><span class="math display">\[
\frac{\partial H}{\partial V} = \lim_{\alpha \rightarrow 1} \frac{\partial H}{\partial \alpha} \frac{d \alpha}{dV} = \lim_{\alpha \rightarrow 1} \frac{\partial H}{\partial \alpha} \frac{1}{3 \alpha^2 V}
\]</span></p>
<p>と、<span class="math inline">\(V\)</span>による微分を<span class="math inline">\(\alpha\)</span>による微分に置き換えることができる。</p>
<p>以下、<span class="math inline">\(\partial H/\partial \alpha\)</span>を計算しよう。</p>
<p>まず、運動エネルギー部分を考える。空間を一辺<span class="math inline">\(\alpha\)</span>倍にすると、<span class="math inline">\(\vec{q}_i \rightarrow \alpha \vec{q}_i\)</span>となる。ここで、</p>
<p><span class="math display">\[
\vec{p}_i = \frac{\partial L}{\partial \dot{\vec{q}}_i}
\]</span></p>
<p>であったから、<span class="math inline">\(\vec{p}_i \rightarrow \vec{p}_i / \alpha\)</span>となることに注意すると、</p>
<p><span class="math display">\[
\begin{aligned}
\lim_{\alpha \rightarrow 1}\frac{\partial K(\alpha)}{\partial \alpha} &amp;=
\lim_{\alpha \rightarrow 1} \sum_i \frac{\partial}{\partial \alpha } \frac{\vec{p}_i^2}{2m \alpha^2} \\
&amp;= -2K \\
&amp;= -3 N k_B T
\end{aligned}
\]</span></p>
<p>ただし、途中でエネルギー等分配則を用いた。</p>
<p>次にポテンシャル部分の計算であるが、まずポテンシャル項の<span class="math inline">\(\alpha\)</span>微分は</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1}  \frac{\partial\Phi(\alpha q_{ij})}{\partial \alpha} 
= \Phi&#39;(q_{ij}) q_{ij} \]</span></p>
<p>ここで、</p>
<p><span class="math display">\[
q_{ij} = |\vec{q}_i - \vec{q}_j|
\]</span></p>
<p>である。粒子<span class="math inline">\(j\)</span>から<span class="math inline">\(i\)</span>に働く力<span class="math inline">\(\vec{f}_{ij}\)</span>は</p>
<p><span class="math display">\[
\vec{f}_{ij} = - \Phi&#39;(q_{ij}) \frac{\vec{q}_i - \vec{q}_j}{|\vec{q}_i - \vec{q}_j|}\]</span></p>
<p>である(ベクトルの向きに注意)。以上をまとめると、</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1}  \frac{\partial \Phi(\alpha q_{ij})}{\partial \alpha}  = -\vec{q}_{ij} \cdot \vec{f}_{ij}
\]</span></p>
<p>となるので、両辺和を取れば、</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1} \sum_{i&lt; j} \frac{\partial \Phi(\alpha q_{ij})}{\partial \alpha} = -\sum_{i &lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}\\
\]</span></p>
<p>以上から、</p>
<p><span class="math display">\[
\begin{aligned}
-P &amp;= \left&lt;\frac{\partial H}{\partial V} \right&gt;_S\\
&amp;= \lim_{\alpha \rightarrow 1} \left&lt;\frac{\partial H}{\partial \alpha}\right&gt; \underbrace{\frac{d \alpha}{d V}}_{1/3V} \\
&amp;= \frac{1}{3V} \left(- 3 Nk_B T -  \right&lt;\sum_{i &lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij} \left&gt;\right)
\end{aligned}
\]</span></p>
<p>整理すると、</p>
<p><span class="math display">\[
PV = N k_BT + \frac{1}{3} \left&lt; \sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}\right&gt;
\]</span></p>
<p>先程ビリアル定理で導かれた圧力が導出された。導出を見れば、分母の<span class="math inline">\(3V\)</span>は<span class="math inline">\(d\alpha /d V\)</span>から、<span class="math inline">\(Nk_B T\)</span>の項は運動エネルギー由来、ビリアル項は相互作用由来であることがわかるであろう。また、境界条件に依存しない導出であることもわかるであろう。</p>
<p>分子動力学法では<span class="math inline">\(\vec{q}_{ij} \cdot \vec{f}_{ij}\)</span>は容易に計算できるため、これで圧力が計算できることになる。</p>
<h2 id="局所圧力">局所圧力</h2>
<p>さて、ビリアル定理にて全体的な圧力は定義できたが、MDシミュレーションをしていると局所圧力を知りたいことがある。例えばいま、直方体の領域で、気液の相分離が起きているとしよう。中央に気液界面があるとする。気液共存領域では、その温度、圧力、密度における気相と液相の自由エネルギー密度が一致するため、どちらの状態でも良い。しかし、気液界面付近にいる粒子はとても不幸な状態であるため、界面の面積を減らそうとする。</p>
<div class="figure">
<img src="phaseboundary.png" alt="相共存する系には相界面が存在する" />
<p class="caption">相共存する系には相界面が存在する</p>
</div>
<p>この、面積を減らそうとする熱力学的力が界面張力である。界面張力により、界面付近では圧力異常が起きる。具体的には、圧力の界面に垂直方向には何も異常が起きない(一定圧力)であるが、界面に並行な方向では圧力が下がるように見える。直感的には、水平方向は界面張力があるため、界面張力と一緒に圧力を支える分、粒子からの寄与が下がるのが原因である。</p>
<p>この、界面付近の圧力構造を可視化したいとする。とりあえず系をビンに区切って、そのビン内の平均圧力を定義することで局所圧力を可視化することを考えよう。当然、界面の構造がわかる程度の解像度で局所圧力を定義しなければならない。以下は、ある温度<span class="math inline">\(T=0.7\)</span>におけるLennard-Jones粒子系の気液共存状態の密度プロファイルだ。</p>
<div class="figure">
<img src="density.png" alt="気液共存状態の密度プロファイル" />
<p class="caption">気液共存状態の密度プロファイル</p>
</div>
<p>左にある高密度状態が液相、右側が気相である。気液界面は、<span class="math inline">\(\tanh((x_c-x)/\lambda)\)</span>でよくフィットできることが知られている。ここで<span class="math inline">\(x_c\)</span>が界面位置、<span class="math inline">\(\lambda\)</span>は界面厚さである。例えばLJ単位系で<span class="math inline">\(T=0.7\)</span>の時の厚さは<span class="math inline">\(\lambda = 1.1\)</span>程度である。LJ系のカットオフは2.5〜3.5程度に取るため、カットオフ距離よりも小さいビンに切って圧力を定義する必要がある。すなわち、粒子が二つ以上離れたビンに存在する時、間に挟まれた(粒子のいない)ビンは、その粒子間の相互作用に起因する圧力を感じるべきかを決めなければならない。</p>
<div class="figure">
<img src="local_pressure.png" alt="局所圧力定義の問題" />
<p class="caption">局所圧力定義の問題</p>
</div>
<p>先に答えを言うと、「この人は粒子による圧力を感じる」と定義した方が良いことが知られている。以下、その局所圧力定義を導出してみよう。</p>
<h3 id="応力テンソルの定義">応力テンソルの定義</h3>
<p>系に含まれる粒子<span class="math inline">\(i\)</span>の位置を<span class="math inline">\(\vec{q}^i\)</span>、運動量を<span class="math inline">\(\vec{p}^{i}\)</span>とする。後で座標の成分を明示したいので、粒子のインデックスは上付きにしておく。</p>
<p>この系の密度分布関数は</p>
<p><span class="math display">\[
\rho(\vec{r}) = m \sum_i \delta(\vec{q^i} - \vec{r})
\]</span></p>
<p>で定義される。要するに粒子のある場所にデルタ関数的に質量が存在しているとする定義である。同様に、運動量分布関数<span class="math inline">\(\vec{g}(\vec{r})\)</span>も、</p>
<p><span class="math display">\[
\vec{g}(\vec{r}) = \sum_i \vec{p^i} \delta(\vec{q^i} - \vec{r})
\]</span></p>
<p>と定義できる。これはベクトル場であり、後の便利の時に成分表示をしておく。</p>
<p><span class="math display">\[
g_\alpha(\vec{r}) = \sum_i p^i_\alpha \delta(\vec{q^i} - \vec{r})
\]</span></p>
<p>ただし<span class="math inline">\(\alpha = [x, y, z]\)</span>である。ここで、応力テンソル分布関数を<span class="math inline">\(\pi_{\alpha \beta}\)</span>としよう。運動量分布<span class="math inline">\(g_\alpha\)</span>と応力テンソル<span class="math inline">\(\pi_{\alpha \beta}\)</span>の間には、連続の式</p>
<p><span class="math display">\[
\frac{D g_\alpha}{Dt} = -\frac{\partial \pi_{\alpha \beta}}{\partial x_\beta}
\]</span></p>
<p>が要請される。ただし<span class="math inline">\(D/Dt\)</span>はラグランジュ微分である。これは「運動量分布の時間変化は、ストレステンソルのdivergenceに比例する」ということを表しており、要するに<span class="math inline">\(f=ma\)</span>の分布関数版である。これが全ての空間で無矛盾に成立するように、局所的な応力テンソル分布関数を決めるのが以下の目的である。</p>
<p>まずは運動量分布関数の式からスタートする。</p>
<p><span class="math display">\[
g_\alpha(\vec{r}) = \sum_i p^i_\alpha \delta(\vec{q^i} - \vec{r})
\]</span></p>
<p>両辺を時間でラグランジュ微分しよう。分布に関するラグランジュ微分は、粒子のとっての常微分になることに注意。</p>
<p><span class="math display">\[
\begin{aligned}
\frac{D g_\alpha}{Dt} &amp;= \sum_i p^i_\alpha \dot{q^i_\alpha} \frac{\partial}{\partial q^i_\beta} \delta(\vec{q^i}-\vec{r})
+ \sum_i \dot{p^i_\alpha}  \delta(\vec{q^i}-\vec{r}) \\
&amp;= \underbrace{\sum_i \frac{p^i_\alpha p^i_\beta}{m} \frac{\partial}{\partial q^i_\beta} \delta(\vec{q^i}-\vec{r})}_A
+ 
\underbrace{\sum_i f^i_\alpha \delta(\vec{q^i}-\vec{r})}_B
\end{aligned}
\]</span></p>
<p>右辺第一項の<span class="math inline">\(A\)</span>は、運動エネルギーからの寄与分であり、理想気体ではこの項しか存在しない。第二項の<span class="math inline">\(B\)</span>はポテンシャル項からの寄与分だ。そこで、応力テンソルを</p>
<p><span class="math display">\[
\pi_{\alpha \beta} = \pi_{\alpha \beta}^K +  \pi_{\alpha \beta}^U 
\]</span></p>
<p>と、運動項とポテンシャル項に分けよう。先程の連続の式は、</p>
<p><span class="math display">\[
\frac{D g_\alpha}{Dt} = -\frac{\partial \pi_{\alpha \beta}^K}{\partial x_\beta}-\frac{\partial \pi_{\alpha \beta}^U}{\partial x_\beta}
\]</span></p>
<p>となる。</p>
<p>まず、<span class="math inline">\(A\)</span>については、</p>
<p><span class="math display">\[
\begin{aligned}
A &amp;= \sum_i \frac{p^i_\alpha p^i_\beta}{m} \frac{\partial}{\partial q^i_\beta} \delta(\vec{q^i}-\vec{r}) \\
&amp;= - \frac{\partial}{\partial x_\beta}
\underbrace{
\left[
\frac{p^i_\alpha p^i_\beta}{m} 
\delta(\vec{q^i}-\vec{r})
\right]}_{\pi_{\alpha \beta}^K} \\
&amp;= - \frac{\partial \pi_{\alpha \beta}^K}{\partial x_\beta}
\end{aligned}
\]</span></p>
<p>以上から、</p>
<p><span class="math display">\[
\pi_{\alpha \beta}^K = \sum_i \frac{p^i_\alpha p^i_\beta}{m} 
\delta(\vec{q^i}-\vec{r})
\]</span></p>
<p>と定義するのが妥当であることがわかる。</p>
<p>次に、ポテンシャル項<span class="math inline">\(\pi_{\alpha \beta}^U\)</span>を求めよう。</p>
<p>運動が二体ポテンシャル<span class="math inline">\(\phi\)</span>によって支配されているとするならば、粒子<span class="math inline">\(i\)</span>にかかる力の<span class="math inline">\(\alpha\)</span>成分<span class="math inline">\(f_\alpha^i\)</span>は</p>
<p><span class="math display">\[
f_\alpha^i = - \sum_j \frac{\partial U(q_{ij})}{\partial q_\alpha^i}
\]</span></p>
<p>であるので、</p>
<p><span class="math display">\[
\begin{aligned}
B &amp;= \sum_i f^i_\alpha  \delta(\vec{q^i}-\vec{r}) \\
&amp;= -\sum_i \sum_j\frac{\partial U(q_{ij})}{\partial q_\alpha^i} \delta(\vec{q^i}-\vec{r})\\
&amp;= - \sum_{i &lt; j} \frac{\partial U(q_{ij})}{\partial q_\alpha^i} 
\left[
\delta(\vec{q^i}-\vec{r}) - \delta(\vec{q^j}-\vec{r})
\right]
\end{aligned}
\]</span></p>
<p>ここをdivergenceの形に書き直したいので、デルタ関数の部分を以下のように変形する(Appendix参照)。</p>
<p><span class="math display">\[
\delta(\vec{q^i}-\vec{r}) - \delta(\vec{q^j}-\vec{r}) 
= -\frac{\partial}{x_\beta} (q_\beta^i - q_\beta^j)
\int_0^1 d\lambda 
\delta(\vec{q}^i - \vec{r} + \lambda(\vec{q^j} - \vec{q^i}))
\]</span></p>
<p>これを先程の式に代入し、位置に関する微分が粒子の座標と可換であることを用いると、</p>
<p><span class="math display">\[
\begin{aligned}
B &amp; = \frac{\partial}{\partial x_\beta}
\underbrace{
\sum_{i &lt; j} (q_\beta^i - q_\beta^j)\frac{\partial U(q_{ij})}{\partial q_\alpha^i}
\int_0^1 d\lambda 
\delta(\vec{q}^i - \vec{r} + \lambda(\vec{q^j} - \vec{q^i}))}_{-\pi_{\alpha\beta}^U} \\
&amp;= -\frac{\partial \pi_{\alpha \beta}^U}{\partial x_\beta}
\end{aligned}
\]</span></p>
<p>以上から、</p>
<p><span class="math display">\[
\pi_{\alpha \beta}^U = - \sum_{i &lt; j} (q_\beta^i - q_\beta^j)\frac{\partial U(q_{ij})}{\partial q_\alpha^i}
\int_0^1 d\lambda 
\delta(\vec{q}^i - \vec{r} + \lambda(\vec{q^j} - \vec{q^i}))
\]</span></p>
<p>と定義するのが妥当であることがわかった。これで、局所的な応力テンソル<span class="math inline">\(\pi_{\alpha \beta}\)</span>が求まった。</p>
<h3 id="局所応力テンソルの意味">局所応力テンソルの意味</h3>
<p>応力は二階のテンソルであり、三次元であれば3行3列の行列となる。その対角成分が垂直応力、非対角項がせん断応力に対応する。</p>
<p>応力テンソルは、運動量に関する連続の式、つまり「運動量分布の時間微分が応力テンソルの発散となる」ことから、以下のように定義された。</p>
<p><span class="math display">\[
\frac{D g_\alpha}{Dt} = -\frac{\partial \pi_{\alpha \beta}}{\partial x_\beta}
\]</span></p>
<p>ベクトルで書くと</p>
<p><span class="math display">\[
\frac{D \vec{g}}{Dt} = - \mathrm{div} \Pi
\]</span></p>
<p>と書ける。ここで、適当なベクトル場<span class="math inline">\(\vec{A}\)</span>を持ってきて、<span class="math inline">\(\Pi\)</span>を<span class="math inline">\(\Pi + \mathrm{rot} A\)</span>としても、</p>
<p><span class="math display">\[
\mathrm{div} \cdot \mathrm{rot} \vec{A} = 0
\]</span></p>
<p>であるから、元の式が変わらない。従って、応力テンソルには任意のベクトル場<span class="math inline">\(\vec{A}\)</span>について<span class="math inline">\(\mathrm{rot} A\)</span>のゲージ不定性がある。ひらたく言うと、応力テンソルが微分の形で定義されているから、積分定数の不定性が生じる。分子シミュレーションで局所圧力を計算するためには、何かしらゲージを決めなければならない。ここで、先程の計算のように決める方法をIrving-Kirkwoodゲージと呼ぶ。</p>
<p>Irving-Kirkwoodゲージの最終的な式はかなりごちゃごちゃしたが、とにかく場の関数として応力テンソルが決まった。流体であれば応力テンソルの対角項しか存在しないので、静水圧の<span class="math inline">\(x,y,z\)</span>成分のみに落ちる。シミュレーションでは、局所圧力は計算する系をセルもしくはビンに分割し、その内部について応力テンソルを全て積分したものとして決まる。運動項は一体分布関数なので、そのセルに入っている粒子の分を数えるだけである。問題は粒子間相互作用のあるポテンシャル由来の項だが、Irving-Kirkwoodの式を積分すると、「粒子対の持つビリアルを、観測するスライスにまたがる割合に応じて分配せよ」ということになる。</p>
<div class="figure">
<img src="irving-kirkwood.png" alt="Irving-Kirkwoodゲージによる圧力の分配" />
<p class="caption">Irving-Kirkwoodゲージによる圧力の分配</p>
</div>
<p>すなわち、Irving-Kirkwoodゲージでは、粒子が含まれないビンにいる観測者にも、粒子の相互作用からくる圧力を感じる、という解釈を取る。</p>
<p>ここでは二体相互作用の場合を考えたが、三体以上の相互作用があるとかなり面倒になる。この時にどのように圧力を決めるべきかは未だに議論があるようだ。</p>
<p>参考文献：</p>
<ul>
<li>J. H. irving and J. G. Kirkwood, &quot;The Statistical Mechanical Theory of Transport Processes. IV. The Equations of Hydrodynamics&quot;, <a href="https://doi.org/10.1063/1.1747782">J. Chem. Phys. 18, 817 (1950)</a></li>
<li>R. Goetz and R. Lipowsky, &quot;Computer simulations of bilayer membranes: Self-assembly and interfacial tension&quot;, <a href="https://doi.org/10.1063/1.476160">J. Chem. Phys. 108, 7397 (1998)</a></li>
<li>K. M. Nakagawa and H. Noguchi, &quot;Nonuniqueness of local stress of three-body potentials in molecular simulations&quot;, <a href="https://doi.org/10.1103/PhysRevE.94.053304">Phys. Rev. E 94, 053304/1-11 (2016)</a></li>
</ul>
<h3 id="appendixデルタ関数のdivergenceを用いた書き換え">Appendix:デルタ関数のdivergenceを用いた書き換え</h3>
<p>TODO: そのうち書く？ 少なくとも講義では触れない。</p>
</article>
</body>
</html>
