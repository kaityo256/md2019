<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>

<style>
    .btn-square {
      display: inline-block;
      padding: 0.5em 0.5em;
      text-decoration: none;
      background: #668ad8;
      color: #FFF;
      border-bottom: solid 4px #626295;
      border-radius: 5px;
    }

    .btn-square:active {
      -webkit-transform: translateY(4px);
      transform: translateY(4px);
      border-bottom: none;
    }
  .markdown-body {
    box-sizing: border-box;
    min-width: 200px;
    max-width: 980px;
    margin: 0 auto;
    padding: 45px;
  }
  p.caption{
    display:none;
  }
  img {width: 100%}

  @media (max-width: 767px) {
    .markdown-body {
      padding: 15px;
    }
  }
</style>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://kaityo256.github.io/python_zero/github-markdown.css" type="text/css" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
</head>
<body>
<article class="markdown-body">
<h1 id="圧力">圧力</h1>
<p><a href="../index.html">[Up]</a> <a href="https://github.com/kaityo256/md2019">[Repository]</a></p>
<h2 id="圧力の定義">圧力の定義</h2>
<p>しつこいが、分子動力学法において規定されているのは全エネルギーのみである。それ以外の物理量は我々が定義しなければならない。ここでは、圧力について考えてみよう。</p>
<h2 id="古典的なビリアル定理">古典的なビリアル定理</h2>
<p>まずは教科書によく書いてある古典的なビリアル定理から圧力を定義してみよう。天下りだが、以下のような量を考えよう。</p>
<p><span class="math display">\[
G = \sum_i \vec{p}_i \cdot \vec{q}_i
\]</span></p>
<p>両辺を時間微分してみる。</p>
<p><span class="math display">\[
\begin{aligned}
\dot{G} &amp;= \sum_i \underbrace{\vec{p}_i \cdot \dot{\vec{q}}_i}_{(1)} + \sum_i \underbrace{\dot{\vec{p}}_i \cdot \vec{q}_i}_{(2)}
\end{aligned}
\]</span></p>
<p>まず(1)の項だが、<span class="math inline">\(\dot{\vec{q}}_i = \vec{p}_i/m\)</span>であるから、</p>
<p><span class="math display">\[
\vec{p}_i \cdot \dot{\vec{q}}_i  = \frac{\vec{p}_i^2}{m}
\]</span></p>
<p>である。エネルギー等分配則から</p>
<p><span class="math display">\[
\frac{\vec{p}_i^2}{m} = 3 k_B T
\]</span></p>
<p>和を取ると、</p>
<p><span class="math display">\[
\sum_i \frac{\vec{p}_i^2}{m} = 3 Nk_B T
\]</span></p>
<p>次に、(2)だが、<span class="math inline">\(\dot{\vec{p}}_i = \vec{f}_i\)</span>であるから、</p>
<p><span class="math display">\[
\dot{\vec{p}}_i \cdot \vec{q}_i = \vec{q}_i \cdot \vec{f}_i 
\]</span></p>
<p>ここで<span class="math inline">\(\vec{f}_i\)</span>は、粒子<span class="math inline">\(i\)</span>にかかる力である。ここで、粒子間に働く力と、外力<span class="math inline">\(\vec{f}^\mathrm{ext}_i\)</span>にわけよう。粒子間力は二体力とし、粒子<span class="math inline">\(j\)</span>から<span class="math inline">\(i\)</span>に働く力を<span class="math inline">\(\vec{f}_{ij}\)</span>とすると、</p>
<p><span class="math display">\[
\dot{\vec{p}}_i \vec{q}_i = \vec{q}_i \sum_{i\neq j} \vec{f}_{ij} + \vec{q}_i  \cdot \vec{f}^\mathrm{ext}_i
\]</span></p>
<p>と書ける。<span class="math inline">\(i\)</span>に関する和を取ると、</p>
<p><span class="math display">\[
\begin{aligned}
\sum_i \dot{\vec{p}}_i \vec{q}_i &amp;= \underbrace{\sum_i \vec{q}_i \sum_{i\neq j} \vec{f}_{ij}}_{(3)} + \underbrace{\sum_i \vec{q}_i \cdot \vec{f}^\mathrm{ext}_i}_{(4)}
\end{aligned}
\]</span></p>
<p>まずは(3)について計算しよう。</p>
<p><span class="math display">\[
\begin{aligned}
(3) &amp;=  \sum_i \vec{q}_i \sum_{i\neq j} \vec{f}_{ij} \\
&amp;= \sum_{i&lt; j} \left( \vec{q}_i  \cdot \vec{f}_{ij} + \vec{q}_j  \cdot \vec{f}_{ji} \right) \\
&amp;=  \sum_{i&lt; j}\left( \vec{q}_i  \cdot \vec{f}_{ij} - \vec{q}_j  \cdot \vec{f}_{ij} \right) \\
&amp;=  \sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}
\end{aligned}
\]</span></p>
<p>ただし、<span class="math inline">\(\vec{q}_{ij} = \vec{q}_i - \vec{q}_j\)</span>である。</p>
<p>次に、外力からの寄与(4)を計算する。<span class="math inline">\(\vec{f}^\mathrm{ext}_i\)</span>は、外力から粒子<span class="math inline">\(i\)</span>に働く力であるから、その反作用が壁に働く。従って、</p>
<p><span class="math display">\[
\begin{aligned}
(4) &amp;= \sum_i \vec{q}_i \cdot \vec{f}^\mathrm{ext}_i \\
&amp;= -  \int_{\partial V} \vec{r} \cdot (P\vec{n}) d A \\
&amp;= -P \int_V \underbrace{\nabla \cdot \vec{r}}_3 dV \\
&amp;= -3PV
\end{aligned}
\]</span></p>
<p>ただし、途中でガウスの定理を使った。また、</p>
<p><span class="math display">\[
\nabla \cdot \vec{r} = \frac{\partial x}{\partial x} +
\frac{\partial y}{\partial y} +
\frac{\partial z}{\partial z}  = 3
\]</span></p>
<p>を用いた。</p>
<p>以上から、</p>
<p><span class="math display">\[
\dot{G} = 3Nk_B T + \sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij} -3PV
\]</span></p>
<p>となった。</p>
<p>次に、両辺の時間平均を取ろう。時間変化する物理量<span class="math inline">\(A(t)\)</span>の時間平均<span class="math inline">\(\bar{A}\)</span>は、</p>
<p><span class="math display">\[
\bar{A} \equiv \lim_{\tau \rightarrow \infty} \frac{1}{\tau}
\int_0^\tau dt A(t)
\]</span></p>
<p>で定義される。<span class="math inline">\(\dot{G}\)</span>の時間平均は</p>
<p><span class="math display">\[
\begin{aligned}
\bar{\dot{G}} &amp;= \lim_{\tau \rightarrow \infty} \frac{1}{\tau}
\int_0^\tau dt \dot{G}(t)\\
&amp;= \lim_{\tau \rightarrow \infty} \frac{G(\tau) - G(0)}{\tau}
\end{aligned}
\]</span></p>
<p>ここで、<span class="math inline">\(G\)</span>という量に上限があるなら、十分に長い<span class="math inline">\(\tau\)</span>を取ればゼロになる。以上から、</p>
<p><span class="math display">\[
\bar{\dot{G}} = 3Nk_B T + \overline{\sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}} -3PV = 0
\]</span></p>
<p>時間平均<span class="math inline">\(\bar{A}\)</span>とアンサンブル平均<span class="math inline">\(\left&lt; A\right&gt;\)</span>を同一視すると、</p>
<p><span class="math display">\[
PV = N k_BT + \frac{1}{3} \left&lt; \sum_{i&lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}\right&gt;
\]</span></p>
<p>これが古典的なビリアル定理による、粒子系の圧力の導出である。最初の<span class="math inline">\(N k_B T\)</span>が理想気体からの寄与、つまり粒子の運動から圧力への寄与であり、右辺第二項が相互作用からの寄与である。</p>
<h2 id="分配関数からの導出">分配関数からの導出</h2>
<p>さて、先ほどのビリアル定理からの圧力の導出では、</p>
<ul>
<li>いきなり<span class="math inline">\(G\)</span>という量を定義して時間微分する意味が不明瞭</li>
<li>粒子にかかる力を粒子間力と外力に分けたが、周期境界条件ではどうなるかわかりにくい</li>
</ul>
<p>という問題がある。そこで、「分子動力学法の世界にはハミルトニアンしか存在しない」という立場から、分配関数経由で導出してみよう。</p>
<p>まずはこの系のハミルトニアンを定義しよう。</p>
<p><span class="math display">\[
H = \sum_i \frac{\vec{p}_i^2}{2m} + \sum_{i &lt; j} \Phi(q_{ij})
\]</span></p>
<p>これがこの系の全エネルギーを定義する。</p>
<p>さて、熱力学関係式</p>
<p><span class="math display">\[
P = - \left(\frac{\partial F}{\partial V} \right)_T
\]</span></p>
<p>から出発しよう。<span class="math inline">\(P\)</span>は圧力、<span class="math inline">\(T\)</span>が温度、<span class="math inline">\(F\)</span>はヘルムホルツ自由エネルギーである。</p>
<p>ヘルムホルツ自由エネルギーは分配関数<span class="math inline">\(Z\)</span>を用いて</p>
<p><span class="math display">\[
F = - k_B T \ln Z
\]</span></p>
<p>と書けるので、</p>
<p><span class="math display">\[
\begin{aligned}
P &amp;= - \left(\frac{\partial F}{\partial V} \right)_T\\
&amp;= k_B T \frac{\partial\ln Z }{\partial V}
= k_B T \frac{1}{Z} \frac{\partial Z}{\partial V}
\end{aligned}
\]</span></p>
<p>となる。さて、分配関数はハミルトニアン<span class="math inline">\(H\)</span>を用いて</p>
<p><span class="math display">\[
Z = \int d \Gamma \mathrm{e}^{-\beta H}
\]</span></p>
<p>と書けるから、</p>
<p><span class="math display">\[
\frac{\partial Z}{\partial V} = \int d \Gamma \left(-\beta \frac{\partial H}{\partial V} \right) \mathrm{e}^{-\beta H}
\]</span></p>
<p>である。これを先程の式に代入して整理すると、</p>
<p><span class="math display">\[
\begin{aligned}
P &amp;= - Z^{-1} \int d \Gamma \left(\frac{\partial H}{\partial V} \right) \mathrm{e}^{-\beta H} \\
&amp;= -\left&lt; \frac{\partial H}{\partial V} \right&gt;
\end{aligned}
\]</span></p>
<p>すなわち、圧力を求めるにはハミルトニアンの体積微分のアンサンブル平均を取れば良い。 もちろんこの式は、熱力学関係式</p>
<p><span class="math display">\[
P = - \left(\frac{\partial U}{\partial V} \right)_S
\]</span></p>
<p>に対応している。</p>
<p>さて、ハミルトニアンの体積微分を取るために、系のサイズを変化させることを考えよう。一辺<span class="math inline">\(L\)</span>の立方体の系を考えると、<span class="math inline">\(V=L^3\)</span>である。この系の長さを一様に<span class="math inline">\(L \rightarrow \alpha L\)</span>と拡大することを考える。</p>
<p>拡大された世界のハミルトニアンは</p>
<p><span class="math display">\[
H(\alpha) = \sum_i \frac{\alpha^2 \vec{p}_i^2}{2m} + \sum_{i &lt; j} \Phi(\alpha q_{ij})
\]</span></p>
<p>となる。</p>
<p>やや紛らわしいが、<span class="math inline">\(\alpha = 1\)</span>の時の体積を<span class="math inline">\(V\)</span>とすると、<span class="math inline">\(V \rightarrow \alpha^3 V\)</span>となるから</p>
<p><span class="math display">\[
dV = 3 \alpha^2 V d \alpha
\]</span></p>
<p>となる(微分する変数としての<span class="math inline">\(V\)</span>と基準体積<span class="math inline">\(V\)</span>で同じ記号を使っていることに注意)。これにより、</p>
<p><span class="math display">\[
\frac{\partial H}{\partial V} = \lim_{\alpha \rightarrow 1} \frac{\partial H}{\partial \alpha} \frac{d \alpha}{dV}
\]</span> <span class="math inline">\(V\)</span>による微分を<span class="math inline">\(\alpha\)</span>による微分に置き換えることができる。</p>
<p>ここで、</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1} \frac{d \alpha}{d V} = \frac{1}{3V}
\]</span></p>
<p>である。</p>
<p>以下、<span class="math inline">\(\partial H/\partial \alpha\)</span>を計算しよう。</p>
<p>まず、運動エネルギー部分は簡単で、</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1}\frac{\partial K(\alpha)}{\partial \alpha} =
\lim_{\alpha \rightarrow 1} \sum_i \frac{2 \alpha \vec{p}_i^2}{2m} = 2K
\]</span></p>
<p>つまり、運動エネルギーの二倍である。等分配則を用いれば、</p>
<p><span class="math display">\[
2K = 3 N k_B T
\]</span></p>
<p>である。</p>
<p>次にポテンシャル部分の計算であるが、まずポテンシャル項の<span class="math inline">\(\alpha\)</span>微分は</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1}  \frac{\partial\Phi(\alpha q_{ij})}{\partial \alpha} 
= \Phi&#39;(q_{ij}) q_{ij} \]</span></p>
<p>ここで、</p>
<p><span class="math display">\[
q_{ij} = |\vec{q}_i - \vec{q}_j|
\]</span></p>
<p>である。粒子<span class="math inline">\(i\)</span>から<span class="math inline">\(j\)</span>に働く力<span class="math inline">\(\vec{f}_{ij}\)</span>は</p>
<p><span class="math display">\[
\vec{f}_{ij} = - \Phi&#39;(q_{ij}) \frac{\vec{q}_j - \vec{q}_i}{|\vec{q}_j - \vec{q}_i|}\]</span></p>
<p>である(ベクトルの向きに注意)。以上をまとめると、</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1}  \frac{\partial \Phi(\alpha q_{ij})}{\partial \alpha}  = \vec{q}_{ij} \cdot \vec{f}_{ij}
\]</span></p>
<p>となるので、両辺和を取れば、</p>
<p><span class="math display">\[
\lim_{\alpha \rightarrow 1} \sum_{i&lt; j} \frac{\partial \Phi(\alpha q_{ij})}{\partial \alpha} = \sum_{i &lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij}\\
\]</span></p>
<p>ただし、途中で作用反作用の法則を用いた。</p>
<p>以上から、</p>
<p><span class="math display">\[
P = \frac{1}{3V} \left(3 Nk_B T +  \sum_{i &lt; j} \vec{q}_{ij} \cdot \vec{f}_{ij} \right)
\]</span></p>
<p>いわゆるビリアル定理が導かれた。導出を見れば、分母の<span class="math inline">\(3V\)</span>は<span class="math inline">\(d\alpha /d V\)</span>から、<span class="math inline">\(Nk_B T\)</span>の項は運動エネルギー由来、ビリアル項は相互作用由来であることがわかるであろう。</p>
</article>
</body>
</html>
