# 分子動力学法の理論と実装

## この文書について

これは金沢大学で行われる集中講義の講義ノートにする予定。

## 内容

* 本講義の概要と目的
* 分子動力学法の理論的背景
  * 圧力と界面張力
  * 温度制御とエルゴード性
  * 分子動力学法における数値積分法
* 分子動力学法の実装
  * 分子動力学法の実装と基本的アルゴリズム
  * 分子動力学法の高速化手法について
  * 分子動力学法の並列化とプログラム設計

## 分子動力学法とは

分子動力学法(Moleclar Dynamics method, MD)とは、ニュートンもしくはハミルトンの運動方程式を数値的に解くことで粒子系を時間発展させる手法である。原子や分子、あるいはそれを粗視化した「つぶつぶ」の間にかかる力を計算し、その力によって速度を更新し、その速度によって位置を更新する、というプロセスを繰り返す。MDの基礎方程式が運動方程式という身近なものであることから、なんとなく「とっつきやすい」「わかりやすい」手法のように見える。しかし、MDという手法を突き詰めて考えてみるとだんだんよくわからなくなってくる。ここで温度と言っているのはどういう量なのか？圧力とは何か？そもそもMDにおける時間発展とはなんなのか？

### 変数と観測量

数値計算は、支配方程式を数値的に解く方法論だ。ここで重要となるのは、変数と観測量の区別である。変数(Variable)とは「我々がa prioriに認める量」であり、観測量(Observable)は、「変数から導かれる量」だ。何が変数で何が観測量かは支配方程式によって異なる。

例えば、一次元熱伝導方程式を考えよう。

$$
\frac{\partial T}{\partial t} = \kappa \frac{\partial^2 T}{\partial x^2}
$$

この方程式では、温度$T$は変数である。つまり、「この世界には温度という量がある」ということを無条件に認めている。

また、ナビエ・ストークス方程式を考えてみよう。粘性率一定、非圧縮を仮定し、外場を$\vec{F}$とすると以下のようになるだろう。

$$
\frac{\partial \vec{v}}{\partial t}
+ \left(\vec{v}\cdot \nabla \right)
= -\frac{1}{\rho} \nabla p + \nu \Delta \vec{v} + \vec{F}
$$

この方程式では、速度場$v$に加えて、圧力場$p$も変数である。

さて、MDではどうだろうか？支配方程式としてハミルトンの運動方程式を採用するとこんな方程式となる。

$$
\begin{aligned}
\dot{p_i} &= -\frac{\partial H}{\partial q_i} \\
\dot{q_i} &= \frac{\partial H}{\partial p_i} 
\end{aligned}
$$

変数は座標$q_i$と運動量$p_i$であり、ここには温度や圧力は表れない。したがって、温度や圧力は$q_i$や$p_i$から定義される観測量となる。熱伝導方程式においては、温度を変数にとっているから「温度とは何か」という問いは意味をもたない。しかし、分子動力学法においては温度は定義するものであるので、「私はこの量を温度と呼ぶ」と宣言することになる。そこには様々な温度の定義があり得る。もちろん平衡状態では熱力学と整合するように選ばれるべきだが、後で見るように、異なる温度の定義は非平衡状態では一致しない。MDにおいては「温度とは何か」という問いは本質的な問いとなる。同様にMDにおいては圧力も定義するものであり、その定義には複数の立場があり得る。特に界面がある系における圧力定義は微妙な問題となるので、後でそれにも触れる。

## 温度とは

## 圧力とは
